<html>
<head>
	<link href='http://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet' type='text/css'/>
    <!-- Load the d3 library. -->
    <script src="http://d3js.org/d3.v3.min.js" charset="utf-8"></script>
    <script src="http://d3js.org/topojson.v1.min.js"></script>
    <style>
        /* put a border around the svg element so we can see the coordinate system better. */
        body { font-family: "Open Sans"; } 
        div { margin: 30px; }
        /*circle {fill= }*/
        /*svg { border: solid black 1px; /*height: 75vh; width: 75vw*/ }*/
        /* The default styles for axis elements stink. What should they be? */
        .axis path {}
        .axis line {}
    </style>
</head>

 <!-- Things to do: 
 1) Change jsonData to read actual data file
 2) Uncomment color in path declaration once data is inputted and comment old color assignment
 3) Create Legend. You can ignore my code and here is a helpful link: http://stackoverflow.com/questions/13573771/adding-a-chart-legend-in-d3
 4) Design Doc-->
    
<body>

<h3 style="font-family: Times New Roman" align="center">San Fransisco Bay Area Bike Share Usage</h3>
<h4 style="font-family: Times New Roman" align="center">August 2013 - August 2014</h4>

<div id="canvas" align="center"></div>

<script>
// Dimensions of sunburst
var width = 800;
var height = 700;
var radius = Math.min(width, height) / 4;
var onedayangle = 2*Math.PI/365.0;
var halfdayangle= Math.PI/365.0;
var total=100;

//var jsonData = [{"total" : 40},{"total" : 100},{"total" : 60},{"total" : 20},{"total" : 90} ];

var svg = d3.select("#canvas").append("svg")
    .attr("width", width)
    .attr("height", height)
    .append("g")
    .attr("transform", "translate(" + width / 2 + "," + height * .52 + ")");
//center the circle to the new origin (0,0)
    
//pattern fill for circle
var pattern = svg
    .append("defs")

    .append("pattern").attr("id", "pattern")
    .attr("patternUnits", "objectBoundingBox").attr("height","1").attr("width","1")
    .attr("viewBox", "0 0 1 1").attr("preserveAspectRatio","xMidYMid slice")

    .append("image")
    .attr("height","1").attr("width","1")
    .attr("preserveAspectRatio","xMidYMid slice")
    .attr("xlink:href", "biker.jpg")

//center circle
var circle = svg
    .append("circle")
    .attr("id", "circ")
    .attr("cx", 0)
    .attr("cy", 0)
    .attr("r", radius)
    .attr("fill", "url(#pattern)")
    .style("fill-opacity", 0.9)
    .style("border", "");
    
/*document.getElementById("circle").setAttribute("fill", "src='biker.jpg'");*/

//top right label
var fall = svg.append("text")
    .style("font-size", "20px")
    .style("font-family", "Times New Roman")
    .attr("x", 250)
    .attr("y", -300)
    .text("Fall")
    .attr("text-anchor", "middle")
    .attr("fill", "red");    

//bottom right label
var winter = svg.append("text")
    .style("font-size", "20px")
    .style("font-family", "Times New Roman")
    .attr("x", 250)
    .attr("y", 300)
    .text("Winter")
    .attr("text-anchor", "middle")
    .attr("fill", "blue"); 

//bottom left label
var Summer = svg.append("text")
    .style("font-size", "20px")
    .style("font-family", "Times New Roman")
    .attr("x", -250)
    .attr("y", 300)
    .text("Summer")
    .attr("text-anchor", "middle")
    .attr("fill", "#FFCC00");

//top left label
var Spring = svg.append("text")
    .style("font-size", "20px")
    .style("font-family", "Times New Roman")
    .attr("x", -250)
    .attr("y", -300)
    .text("Spring")
    .attr("text-anchor", "middle")
    .attr("fill", "green");  
    

var bikeData;
    
d3.json("final_data.json", function(error, data) {
    bikeData = data;
    
    //var date = bikeData.Date;
    //var customers = bikeData.Customers;
    //var totalRiders = bikeData.Total;
    //var subscribers = bikeData.Subscribers;
    //var colors = bikeData.Color;
    

//create arc to represent the bar for each day's bike usage
var arc = d3.svg.arc()
    .startAngle(function(d, i) {return (i*onedayangle)-halfdayangle;})
    .endAngle(function(d, i) {return (i*onedayangle)+halfdayangle;})
    .innerRadius(function(d) {return radius;})
    .outerRadius(function(d) {return (.1*d.Total)+radius;});
 
 
//create the actual bars from data
var path = svg.selectAll("path")
    .data(bikeData)
    .enter()
    .append("path")
    .attr("d", arc)
    // .style("stroke", "black")
    //comment below once data is in
    //.style("fill", "red");
    //uncomment below once data is in
    .style("fill", function(d) {return d.Color});
    
});
</script>


</body>
</html>
